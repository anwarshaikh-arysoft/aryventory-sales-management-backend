import{r as o,j as e,a as F}from"./app-BP4yl3BC.js";import{c as q,a as S,B as u}from"./app-logo-icon-DEZI2dJj.js";import{C as O,a as W,b as X,d as Y,c as Z}from"./card-Kb3HfW26.js";import{I as A}from"./input-Dq2P0aCI.js";import{B as ee}from"./badge-C9qeZdp-.js";import{P as ae,S as se,a as te,b as re,c as ne,d as le,e as ce}from"./select-D0kngPwl.js";import{T as oe}from"./trash-2-6HQcmOCw.js";import{D as z,a as H,b as I,c as B,d as V,e as Q}from"./dialog-CnCDzEzS.js";import{L as $}from"./label-CVruneVp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ie=q("SquarePen",de);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],he=q("TriangleAlert",me),U=o.forwardRef(({className:r,...s},n)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:n,className:S("w-full caption-bottom text-sm",r),...s})}));U.displayName="Table";const G=o.forwardRef(({className:r,...s},n)=>e.jsx("thead",{ref:n,className:S("[&_tr]:border-b",r),...s}));G.displayName="TableHeader";const J=o.forwardRef(({className:r,...s},n)=>e.jsx("tbody",{ref:n,className:S("[&_tr:last-child]:border-0",r),...s}));J.displayName="TableBody";const xe=o.forwardRef(({className:r,...s},n)=>e.jsx("tfoot",{ref:n,className:S("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s}));xe.displayName="TableFooter";const P=o.forwardRef(({className:r,...s},n)=>e.jsx("tr",{ref:n,className:S("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s}));P.displayName="TableRow";const M=o.forwardRef(({className:r,...s},n)=>e.jsx("th",{ref:n,className:S("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s}));M.displayName="TableHead";const R=o.forwardRef(({className:r,...s},n)=>e.jsx("td",{ref:n,className:S("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s}));R.displayName="TableCell";const ue=o.forwardRef(({className:r,...s},n)=>e.jsx("caption",{ref:n,className:S("mt-4 text-sm text-muted-foreground",r),...s}));ue.displayName="TableCaption";function Ce({title:r,description:s,apiEndpoint:n,columns:y,onAdd:k,onEdit:D,onDelete:p,searchPlaceholder:j="Search...",refreshTrigger:g=0}){const[b,f]=o.useState([]),[N,_]=o.useState(!0),[v,w]=o.useState(""),[L,E]=o.useState(1),[i,a]=o.useState(null),d=async(t=1,l="")=>{try{_(!0);const C=new URLSearchParams({page:t.toString(),per_page:"15",...l&&{q:l}}),c=(await F.get(`${n}?${C}`)).data;c.data&&Array.isArray(c.data)?(f(c.data),a({current_page:c.current_page,last_page:c.last_page,total:c.total,per_page:c.per_page,from:c.from,to:c.to})):Array.isArray(c)?(f(c),a(null)):(f([]),a(null))}catch(C){console.error("Error fetching data:",C),f([])}finally{_(!1)}};o.useEffect(()=>{d(1,v)},[n,g]),o.useEffect(()=>{const t=setTimeout(()=>{d(1,v),E(1)},300);return()=>clearTimeout(t)},[v]);const m=t=>{E(t),d(t,v)},h=(t,l,C)=>{if(t.render)return t.render(l,C);if(t.key.includes(".")){const T=t.key.split(".");let c=C;for(const x of T)if(c=c?.[x],c==null)break;l=c}switch(t.type){case"badge":return e.jsx(ee,{variant:"secondary",children:l});case"date":return l?new Date(l).toLocaleDateString():"-";case"number":return l?.toLocaleString()||"0";case"currency":return l?`₹${Number(l).toLocaleString()}`:"₹0";default:return l||"-"}},K=()=>{if(!i||i.last_page<=1)return null;const t=[],l=5,C=Math.floor(l/2);let T=Math.max(1,i.current_page-C),c=Math.min(i.last_page,T+l-1);c-T+1<l&&(T=Math.max(1,c-l+1));for(let x=T;x<=c;x++)t.push(x);return e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",i.from," to ",i.to," of ",i.total," results"]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>m(i.current_page-1),disabled:i.current_page<=1,children:"Previous"}),t.map(x=>e.jsx(u,{variant:x===i.current_page?"default":"outline",size:"sm",onClick:()=>m(x),children:x},x)),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>m(i.current_page+1),disabled:i.current_page>=i.last_page,children:"Next"})]})]})};return e.jsxs(O,{children:[e.jsxs(W,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(X,{children:r}),s&&e.jsx(Y,{children:s})]}),e.jsxs(u,{onClick:k,children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Add ",r.slice(0,-1)]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(A,{placeholder:j,value:v,onChange:t=>w(t.target.value),className:"pl-10"})]})})]}),e.jsx(Z,{children:N?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})}):e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(G,{children:e.jsxs(P,{children:[y.map(t=>e.jsx(M,{children:t.label},t.key)),e.jsx(M,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(J,{children:b.length===0?e.jsx(P,{children:e.jsx(R,{colSpan:y.length+1,className:"text-center py-8",children:"No data found"})}):b.map(t=>e.jsxs(P,{children:[y.map(l=>e.jsx(R,{children:h(l,t[l.key],t)},l.key)),e.jsx(R,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{size:"sm",variant:"ghost",onClick:()=>D(t),children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(u,{size:"sm",variant:"ghost",onClick:()=>p(t),children:e.jsx(oe,{className:"h-4 w-4"})})]})})]},t.id))})]}),K()]})})]})}function Se({isOpen:r,onClose:s,onSave:n,title:y,description:k,apiEndpoint:D,fields:p,item:j}){const[g,b]=o.useState({}),[f,N]=o.useState({}),[_,v]=o.useState(!1),w=j!==null;o.useEffect(()=>{if(r){if(w&&j)b(j);else{const a={};p.forEach(d=>{a[d.name]=d.type==="number"?0:""}),b(a)}N({})}},[r,j,w,p]);const L=(a,d)=>{b(m=>({...m,[a]:d})),f[a]&&N(m=>({...m,[a]:[]}))},E=async a=>{a.preventDefault(),v(!0),N({});try{const d=w?`${D}/${j.id}`:D;await F[w?"put":"post"](d,g),n(),s()}catch(d){d.response?.status===422?N(d.response.data.errors||{}):console.error("Error saving data:",d)}finally{v(!1)}},i=a=>{const d=f[a.name]||[],m=d.length>0;switch(a.type){case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:a.name,children:[a.label,a.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs(te,{value:g[a.name]?.toString()||"",onValueChange:h=>L(a.name,a.type==="number"?Number(h):h),children:[e.jsx(re,{className:m?"border-red-500":"",children:e.jsx(ne,{placeholder:a.placeholder||`Select ${a.label.toLowerCase()}`})}),e.jsx(le,{children:a.options?.map(h=>e.jsx(ce,{value:h.value.toString(),children:h.label},h.value))})]}),m&&e.jsx("p",{className:"text-sm text-red-500",children:d[0]})]},a.name);case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:a.name,children:[a.label,a.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(A,{id:a.name,type:"number",placeholder:a.placeholder,value:g[a.name]||"",onChange:h=>L(a.name,Number(h.target.value)),className:m?"border-red-500":""}),m&&e.jsx("p",{className:"text-sm text-red-500",children:d[0]})]},a.name);default:return e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:a.name,children:[a.label,a.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(A,{id:a.name,type:"text",placeholder:a.placeholder,value:g[a.name]||"",onChange:h=>L(a.name,h.target.value),className:m?"border-red-500":""}),m&&e.jsx("p",{className:"text-sm text-red-500",children:d[0]})]},a.name)}};return e.jsx(z,{open:r,onOpenChange:s,children:e.jsxs(H,{className:"sm:max-w-[425px]",children:[e.jsxs(I,{children:[e.jsx(B,{children:w?`Edit ${y}`:`Add ${y}`}),k&&e.jsx(V,{children:k})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[p.map(i),e.jsxs(Q,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsx(u,{type:"submit",disabled:_,children:_?"Saving...":w?"Update":"Create"})]})]})]})})}function Te({isOpen:r,onClose:s,onDeleted:n,title:y,description:k,apiEndpoint:D,item:p,itemDisplayName:j="name"}){const[g,b]=o.useState(!1),f=async()=>{if(p){b(!0);try{await F.delete(`${D}/${p.id}`),n(),s()}catch(N){console.error("Error deleting item:",N)}finally{b(!1)}}};return e.jsx(z,{open:r,onOpenChange:s,children:e.jsxs(H,{className:"sm:max-w-[425px]",children:[e.jsxs(I,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(he,{className:"h-5 w-5 text-red-500"}),e.jsxs(B,{children:["Delete ",y]})]}),e.jsx(V,{children:k||`Are you sure you want to delete "${p?.[j]}"? This action cannot be undone.`})]}),e.jsxs(Q,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsx(u,{type:"button",variant:"destructive",onClick:f,disabled:g,children:g?"Deleting...":"Delete"})]})]})})}export{Se as C,Ce as D,Te as a};

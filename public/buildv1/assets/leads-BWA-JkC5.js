import{g as Oe,r as i,j as e,a as F}from"./app-BP4yl3BC.js";import{a as Ue,B as f}from"./app-logo-icon-DEZI2dJj.js";import{C as q,a as H,d as G,b as Q,c as ie}from"./card-Kb3HfW26.js";import{I as g}from"./input-Dq2P0aCI.js";import{a as S,b as C,c as k,d as D,e as h,P as We,S as Ie}from"./select-D0kngPwl.js";import{B}from"./badge-C9qeZdp-.js";import{C as oe}from"./checkbox-B1Q1wIG_.js";import{H as Be}from"./heading-VQydfQAI.js";import{A as $e,U as Ve}from"./app-layout-Cwtnfmx_.js";import{d as me}from"./dayjs.min-DzUWqRzS.js";import{D as Re,a as ze,b as qe,c as He,d as Ge,e as Qe}from"./dialog-CnCDzEzS.js";import{L as _}from"./label-CVruneVp.js";import{E as Je,U as Ke}from"./user-shifts-modal-BPUqUpR5.js";import{C as Xe}from"./circle-check-big-CKjdH_HY.js";import{T as de}from"./trash-2-6HQcmOCw.js";import{D as Ze,P as es,M as ss}from"./phone-DUc77FH3.js";import{M as ts,C as as}from"./map-pin-BhbtIOOa.js";import{P as ns}from"./pen-Br02OG8S.js";/* empty css            */import"./index-B67v5KVH.js";import"./index-3KgsdXlp.js";import"./index-CFvp7uWT.js";import"./calendar-BaWBXnz6.js";var $={exports:{}},rs=$.exports,ce;function ls(){return ce||(ce=1,function(L,o){(function(N,r){L.exports=r()})(rs,function(){var N="day";return function(r,M,n){var w=function(c){return c.add(4-c.isoWeekday(),N)},x=M.prototype;x.isoWeekYear=function(){return w(this).year()},x.isoWeek=function(c){if(!this.$utils().u(c))return this.add(7*(c-this.isoWeek()),N);var y,p,d,b,A=w(this),a=(y=this.isoWeekYear(),p=this.$u,d=(p?n.utc:n)().year(y).startOf("year"),b=4-d.isoWeekday(),d.isoWeekday()>4&&(b+=7),d.add(b,N));return A.diff(a,"week")+1},x.isoWeekday=function(c){return this.$utils().u(c)?this.day()||7:this.day(this.day()%7?c:c-7)};var v=x.startOf;x.startOf=function(c,y){var p=this.$utils(),d=!!p.u(y)||y;return p.p(c)==="isoweek"?d?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):v.bind(this)(c,y)}}})}($)),$.exports}var is=ls();const os=Oe(is),J=i.forwardRef(({className:L,...o},N)=>e.jsx("textarea",{className:Ue("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",L),ref:N,...o}));J.displayName="Textarea";function ds({isOpen:L,onClose:o,onSave:N,lead:r,formOptions:M}){const[n,w]=i.useState({shop_name:"",contact_person:"",mobile_number:"",alternate_number:"",email:"",address:"",area_locality:"",pincode:"",gps_location:"",business_type:"",current_system:"",lead_status:"",plan_interest:"",next_follow_up_date:"",meeting_notes:"",assigned_to:"",action:""}),[x,v]=i.useState({}),[c,y]=i.useState(!1),p=!!r;i.useEffect(()=>{L&&(w(r?{shop_name:r.shop_name||"",contact_person:r.contact_person||"",mobile_number:r.mobile_number||"",alternate_number:r.alternate_number||"",email:r.email||"",address:r.address||"",area_locality:r.area_locality||"",pincode:r.pincode||"",gps_location:r.gps_location||"",business_type:r.business_type?.toString()||"",current_system:r.current_system?.toString()||"",lead_status:r.lead_status?.toString()||"",plan_interest:r.plan_interest||"",next_follow_up_date:r.next_follow_up_date?r.next_follow_up_date.split("T")[0]:"",meeting_notes:r.meeting_notes||"",assigned_to:r.assigned_to?.toString()||"",action:""}:{shop_name:"",contact_person:"",mobile_number:"",alternate_number:"",email:"",address:"",area_locality:"",pincode:"",gps_location:"",business_type:"",current_system:"",lead_status:"",plan_interest:"",next_follow_up_date:"",meeting_notes:"",assigned_to:"",action:""}),v({}))},[L,r]);const d=(t,j)=>{w(O=>({...O,[t]:j})),x[t]&&v(O=>({...O,[t]:[]}))},b=()=>{const t={};return n.shop_name.trim()||(t.shop_name=["Shop name is required"]),n.contact_person.trim()||(t.contact_person=["Contact person is required"]),n.mobile_number.trim()||(t.mobile_number=["Mobile number is required"]),(!n.business_type.trim()||n.business_type==="none")&&(t.business_type=["Business type is required"]),n.email&&n.email.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(t.email=["Please enter a valid email address"])),v(t),Object.keys(t).length===0},A=async t=>{if(t.preventDefault(),!!b()){y(!0);try{const j={shop_name:n.shop_name,contact_person:n.contact_person,mobile_number:n.mobile_number,alternate_number:n.alternate_number||null,email:n.email||null,address:n.address||null,area_locality:n.area_locality||null,pincode:n.pincode||null,gps_location:n.gps_location||null,business_type:n.business_type&&n.business_type!=="none"?parseInt(n.business_type):null,current_system:n.current_system&&n.current_system!=="none"?parseInt(n.current_system):null,lead_status:n.lead_status&&n.lead_status!=="none"?parseInt(n.lead_status):null,plan_interest:n.plan_interest||null,next_follow_up_date:n.next_follow_up_date||null,meeting_notes:n.meeting_notes||null,assigned_to:n.assigned_to&&n.assigned_to!=="none"?parseInt(n.assigned_to):null,action:n.action};p&&r?await F.put(`/api/leads/${r.id}`,j):await F.post("/api/leads",j),N()}catch(j){console.error("Error saving lead:",j),j.response?.status===422&&j.response?.data?.errors?v(j.response.data.errors):j.response?.status===500?v({general:[j.response.data.error||"A server error occurred. Please try again later."]}):v({general:["An error occurred while saving the lead. Please try again."]})}y(!1)}},a=t=>x[t]?.[0]||"";return e.jsx(Re,{open:L,onOpenChange:o,children:e.jsxs(ze,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(qe,{children:[e.jsx(He,{children:p?"Edit Lead":"Add New Lead"}),e.jsx(Ge,{children:p?"Update the lead information below.":"Fill in the details to create a new lead."})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[x.general&&e.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:x.general[0]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"shop_name",children:"Shop Name *"}),e.jsx(g,{id:"shop_name",value:n.shop_name,onChange:t=>d("shop_name",t.target.value),placeholder:"Enter shop name",className:a("shop_name")?"border-red-500":""}),a("shop_name")&&e.jsx("p",{className:"text-sm text-red-600",children:a("shop_name")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"contact_person",children:"Contact Person *"}),e.jsx(g,{id:"contact_person",value:n.contact_person,onChange:t=>d("contact_person",t.target.value),placeholder:"Enter contact person name",className:a("contact_person")?"border-red-500":""}),a("contact_person")&&e.jsx("p",{className:"text-sm text-red-600",children:a("contact_person")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"mobile_number",children:"Mobile Number *"}),e.jsx(g,{id:"mobile_number",value:n.mobile_number,onChange:t=>d("mobile_number",t.target.value),placeholder:"Enter mobile number",className:a("mobile_number")?"border-red-500":""}),a("mobile_number")&&e.jsx("p",{className:"text-sm text-red-600",children:a("mobile_number")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"alternate_number",children:"Alternate Number"}),e.jsx(g,{id:"alternate_number",value:n.alternate_number,onChange:t=>d("alternate_number",t.target.value),placeholder:"Enter alternate number",className:a("alternate_number")?"border-red-500":""}),a("alternate_number")&&e.jsx("p",{className:"text-sm text-red-600",children:a("alternate_number")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"email",children:"Email"}),e.jsx(g,{id:"email",type:"email",value:n.email,onChange:t=>d("email",t.target.value),placeholder:"Enter email address",className:a("email")?"border-red-500":""}),a("email")&&e.jsx("p",{className:"text-sm text-red-600",children:a("email")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"area_locality",children:"Area/Locality"}),e.jsx(g,{id:"area_locality",value:n.area_locality,onChange:t=>d("area_locality",t.target.value),placeholder:"Enter area or locality",className:a("area_locality")?"border-red-500":""}),a("area_locality")&&e.jsx("p",{className:"text-sm text-red-600",children:a("area_locality")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"pincode",children:"Pincode"}),e.jsx(g,{id:"pincode",value:n.pincode,onChange:t=>d("pincode",t.target.value),placeholder:"Enter pincode",className:a("pincode")?"border-red-500":""}),a("pincode")&&e.jsx("p",{className:"text-sm text-red-600",children:a("pincode")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"gps_location",children:"GPS Location"}),e.jsx(g,{id:"gps_location",value:n.gps_location,onChange:t=>d("gps_location",t.target.value),placeholder:"Enter GPS coordinates",className:a("gps_location")?"border-red-500":""}),a("gps_location")&&e.jsx("p",{className:"text-sm text-red-600",children:a("gps_location")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"business_type",children:"Business Type"}),e.jsxs(S,{value:n.business_type,onValueChange:t=>d("business_type",t),children:[e.jsx(C,{className:a("business_type")?"border-red-500":"",children:e.jsx(k,{placeholder:"Select business type"})}),e.jsx(D,{children:M.business_types.map(t=>e.jsx(h,{value:t.id.toString(),children:t.name},t.id))})]}),a("business_type")&&e.jsx("p",{className:"text-sm text-red-600",children:a("business_type")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"current_system",children:"Current System"}),e.jsxs(S,{value:n.current_system,onValueChange:t=>d("current_system",t),children:[e.jsx(C,{className:a("current_system")?"border-red-500":"",children:e.jsx(k,{placeholder:"Select current system"})}),e.jsx(D,{children:M.current_systems.map(t=>e.jsx(h,{value:t.id.toString(),children:t.name},t.id))})]}),a("current_system")&&e.jsx("p",{className:"text-sm text-red-600",children:a("current_system")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"lead_status",children:"Lead Status"}),e.jsxs(S,{value:n.lead_status,onValueChange:t=>d("lead_status",t),children:[e.jsx(C,{className:a("lead_status")?"border-red-500":"",children:e.jsx(k,{placeholder:"Select lead status"})}),e.jsx(D,{children:M.lead_statuses.map(t=>e.jsx(h,{value:t.id.toString(),children:t.name},t.id))})]}),a("lead_status")&&e.jsx("p",{className:"text-sm text-red-600",children:a("lead_status")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"assigned_to",children:"Assigned To"}),e.jsxs(S,{value:n.assigned_to,onValueChange:t=>d("assigned_to",t),children:[e.jsx(C,{className:a("assigned_to")?"border-red-500":"",children:e.jsx(k,{placeholder:"Select user"})}),e.jsxs(D,{children:[e.jsx(h,{value:"none",children:"Unassigned"}),M.users.map(t=>e.jsx(h,{value:t.id.toString(),children:t.name},t.id))]})]}),a("assigned_to")&&e.jsx("p",{className:"text-sm text-red-600",children:a("assigned_to")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"action",children:"Action"}),e.jsxs(S,{value:n.action,onValueChange:t=>d("action",t),children:[e.jsx(C,{className:a("action")?"border-red-500":"",children:e.jsx(k,{placeholder:"Select your action"})}),e.jsxs(D,{children:[e.jsx(h,{value:"Meet",children:"Meet"}),e.jsx(h,{value:"Call",children:"Call"}),e.jsx(h,{value:"Update",children:"Update"})]})]}),a("action")&&e.jsx("p",{className:"text-sm text-red-600",children:a("action")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"next_follow_up_date",children:"Next Follow-up Date"}),e.jsx(g,{id:"next_follow_up_date",type:"date",value:n.next_follow_up_date,onChange:t=>d("next_follow_up_date",t.target.value),className:a("next_follow_up_date")?"border-red-500":""}),a("next_follow_up_date")&&e.jsx("p",{className:"text-sm text-red-600",children:a("next_follow_up_date")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"address",children:"Address"}),e.jsx(J,{id:"address",value:n.address,onChange:t=>d("address",t.target.value),placeholder:"Enter full address",className:a("address")?"border-red-500":"",rows:2}),a("address")&&e.jsx("p",{className:"text-sm text-red-600",children:a("address")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"plan_interest",children:"Plan Interest"}),e.jsx(g,{id:"plan_interest",value:n.plan_interest,onChange:t=>d("plan_interest",t.target.value),placeholder:"Enter plan interest details",className:a("plan_interest")?"border-red-500":""}),a("plan_interest")&&e.jsx("p",{className:"text-sm text-red-600",children:a("plan_interest")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"meeting_notes",children:"Meeting Notes"}),e.jsx(J,{id:"meeting_notes",value:n.meeting_notes,onChange:t=>d("meeting_notes",t.target.value),placeholder:"Enter meeting notes",className:a("meeting_notes")?"border-red-500":"",rows:3}),a("meeting_notes")&&e.jsx("p",{className:"text-sm text-red-600",children:a("meeting_notes")})]}),e.jsxs(Qe,{className:"gap-2",children:[e.jsx(f,{type:"button",variant:"outline",onClick:o,disabled:c,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:c,children:c?"Saving...":p?"Update Lead":"Create Lead"})]})]})]})})}me.extend(os);function Fs(L){const[o,N]=i.useState(null),[r,M]=i.useState(null),[n,w]=i.useState(!0),[x,v]=i.useState(""),[c,y]=i.useState(""),[p,d]=i.useState(""),[b,A]=i.useState(""),[a,t]=i.useState(1),[j,O]=i.useState(10),[ue,V]=i.useState(!1),[he,R]=i.useState(null),[T,U]=i.useState([]),[xe,K]=i.useState(!1),[pe,X]=i.useState(null),[_e,je]=i.useState(0),[fe,ge]=i.useState(0),[E,Z]=i.useState(""),[Y,ee]=i.useState(""),[be,se]=i.useState("today"),te=s=>{let l,m;const u=me();switch(s){case"today":l=u.format("YYYY-MM-DD"),m=u.format("YYYY-MM-DD");break;case"yesterday":l=u.subtract(1,"day").format("YYYY-MM-DD"),m=l;break;case"this_week":l=u.startOf("isoWeek").format("YYYY-MM-DD"),m=u.endOf("isoWeek").format("YYYY-MM-DD");break;case"this_month":l=u.startOf("month").format("YYYY-MM-DD"),m=u.endOf("month").format("YYYY-MM-DD");break;case"last_3_months":l=u.subtract(3,"month").startOf("month").format("YYYY-MM-DD"),m=u.endOf("month").format("YYYY-MM-DD");break;default:return}Z(l),ee(m),se(s),ae(l,m)},ye=()=>{E&&Y&&(se("custom"),ae(E,Y))},ae=async(s,l)=>{try{const m=await F.get("/api/leads-count",{params:{start_date:s,end_date:l}});je(m.data.total_leads),ge(m.data.completed_leads)}catch(m){console.error("Error fetching leads count:",m)}},W=async()=>{w(!0);try{const s=new URLSearchParams({page:a.toString(),per_page:j.toString()});x&&s.append("shop_name",x),c&&s.append("lead_status",c),p&&s.append("business_type",p),b&&s.append("assigned_to",b),E&&s.append("start_date",E),Y&&s.append("end_date",Y);const l=await F.get(`/api/leads?${s.toString()}`);console.log(`/api/leads?${s.toString()}`),N(l.data)}catch(s){console.error("Error fetching leads:",s)}w(!1)},Ne=async()=>{try{const s=await F.get("/api/leads-form-options");M(s.data)}catch(s){console.error("Error fetching form options:",s)}};i.useEffect(()=>{Ne()},[]),i.useEffect(()=>{W(),console.log("Fetched Leads"+o)},[a,j,x,c,p,b,E,Y]),i.useEffect(()=>{te("last_3_months")},[]);const ve=s=>{v(s),t(1)},we=s=>{y(s==="all"?"":s),t(1)},Se=s=>{d(s==="all"?"":s),t(1)},Ce=s=>{A(s==="all"?"":s),t(1)},ke=()=>{R(null),V(!0)},De=s=>{R(s),V(!0)},Le=async s=>{if(confirm("Are you sure you want to delete this lead?"))try{await F.delete(`/api/leads/${s}`),W()}catch(l){console.error("Error deleting lead:",l)}},Me=async()=>{if(T.length===0){alert("Please select leads to delete.");return}if(confirm(`Are you sure you want to delete ${T.length} selected lead(s)?`))try{await F.delete("/api/leads-bulk",{data:{lead_ids:T}}),U([]),W()}catch(s){console.error("Error bulk deleting leads:",s),alert("Error deleting leads. Please try again.")}},Ee=(s,l)=>{U(l?m=>[...m,s]:m=>m.filter(u=>u!==s))},Ye=s=>{U(s&&o?o.data.map(l=>l.id):[])},Fe=s=>{X(s),K(!0)},ne=()=>{V(!1),R(null)},Te=()=>{W(),ne()},Pe=async()=>{try{const s=new URLSearchParams;x&&s.append("shop_name",x),c&&s.append("lead_status",c),p&&s.append("business_type",p),b&&s.append("assigned_to",b),E&&s.append("start_date",E),Y&&s.append("end_date",Y);const l=await F.get(`/api/leads-export?${s.toString()}`,{responseType:"blob"}),m=window.URL.createObjectURL(new Blob([l.data])),u=document.createElement("a");u.href=m;const I=l.headers["content-disposition"];let P="leads_export.csv";if(I){const le=I.match(/filename="(.+)"/);le&&(P=le[1])}u.setAttribute("download",P),document.body.appendChild(u),u.click(),u.remove(),window.URL.revokeObjectURL(m)}catch(s){console.error("Error downloading leads:",s),alert("Error downloading leads. Please try again.")}},Ae=()=>{if(!o)return[];const s=[],l=o.last_page,m=o.current_page,u=Math.max(1,m-2),I=Math.min(l,u+4);for(let P=u;P<=I;P++)s.push(P);return s},re=s=>{switch(s?.toLowerCase()){case"hot":return"destructive";case"warm":return"default";case"cold":return"secondary";default:return"outline"}},z=s=>s?new Date(s).toLocaleDateString():"-";return e.jsxs($e,{breadcrumbs:[{title:"Leads",href:"/leads"}],children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"grid auto-rows-min gap-4 md:grid-cols-2",children:[e.jsxs(q,{className:"flex items-center flex-row p-4 hover:shadow-lg transition-shadow duration-200",children:[e.jsx("div",{className:"bg-blue-100 text-blue-600 p-3 rounded-full",children:e.jsx(Ve,{size:24})}),e.jsxs(H,{className:"ml-4 p-0",children:[e.jsx(G,{className:"text-gray-500",children:"Total Leads"}),e.jsx(Q,{className:"text-2xl font-bold",children:_e})]})]}),e.jsxs(q,{className:"flex items-center flex-row p-4 hover:shadow-lg transition-shadow duration-200",children:[e.jsx("div",{className:"bg-green-100 text-green-600 p-3 rounded-full",children:e.jsx(Xe,{size:24})}),e.jsxs(H,{className:"ml-4 p-0",children:[e.jsx(G,{className:"text-gray-500",children:"Completed Leads"}),e.jsx(Q,{className:"text-2xl font-bold",children:fe})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Be,{title:"Leads Management"}),e.jsxs("div",{className:"flex items-center gap-2",children:[T.length>0&&e.jsxs(f,{onClick:Me,variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Delete Selected (",T.length,")"]}),e.jsxs(f,{onClick:Pe,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"Download CSV"]}),e.jsxs(f,{onClick:ke,className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Add Lead"]})]})]}),e.jsxs(q,{children:[e.jsxs(H,{children:[e.jsx(Q,{children:"All Leads"}),e.jsx(G,{children:"Manage leads, prospects, and customer information for your sales team."})]}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsx(g,{type:"date",value:E,onChange:s=>Z(s.target.value),className:"w-full sm:w-40"}),e.jsx("span",{className:"text-muted-foreground text-center sm:text-left",children:"to"}),e.jsx(g,{type:"date",value:Y,onChange:s=>ee(s.target.value),className:"w-full sm:w-40"}),e.jsx(f,{onClick:ye,className:"w-full sm:w-auto",children:"Apply"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end",children:[{label:"Today",type:"today"},{label:"Yesterday",type:"yesterday"},{label:"This Week",type:"this_week"},{label:"This Month",type:"this_month"},{label:"Last 3 Months",type:"last_3_months"}].map(({label:s,type:l})=>e.jsx(f,{variant:be===l?"default":"outline",size:"sm",onClick:()=>te(l),className:"flex-1 sm:flex-none",children:s},l))})]})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ie,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search by shop name, contact person, email...",value:x,onChange:s=>ve(s.target.value),className:"pl-9"})]}),e.jsxs(S,{value:c||"all",onValueChange:we,children:[e.jsx(C,{className:"w-full sm:w-40",children:e.jsx(k,{placeholder:"Filter by status"})}),e.jsxs(D,{children:[e.jsx(h,{value:"all",children:"All Statuses"}),r?.lead_statuses.map(s=>e.jsx(h,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(S,{value:p||"all",onValueChange:Se,children:[e.jsx(C,{className:"w-full sm:w-40",children:e.jsx(k,{placeholder:"Filter by business"})}),e.jsxs(D,{children:[e.jsx(h,{value:"all",children:"All Business Types"}),r?.business_types.map(s=>e.jsx(h,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(S,{value:b||"all",onValueChange:Ce,children:[e.jsx(C,{className:"w-full sm:w-40",children:e.jsx(k,{placeholder:"Assigned to"})}),e.jsxs(D,{children:[e.jsx(h,{value:"all",children:"All Users"}),r?.users.map(s=>e.jsx(h,{value:s.id.toString(),children:s.name},s.id))]})]})]}),n&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading leads..."})}),!n&&o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left font-medium",children:e.jsx(oe,{checked:o.data.length>0&&T.length===o.data.length,onCheckedChange:Ye})}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Create On"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Shop Details"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Contact"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Business Info"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Status & Rating"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Assigned To"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Next Follow-up"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Completed On"}),e.jsx("th",{className:"p-3 text-right font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:o.data.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/25",children:[e.jsx("td",{className:"p-3",children:e.jsx(oe,{checked:T.includes(s.id),onCheckedChange:l=>Ee(s.id,l)})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:z(s.created_at)})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:e.jsxs("a",{href:`/leads/${s.id}`,className:"flex items-center gap-2 hover:underline",children:[e.jsx(Je,{size:15})," ",s.shop_name]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.area_locality&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ts,{className:"h-3 w-3"}),s.area_locality]})})]})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.contact_person}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(es,{className:"h-3 w-3"}),s.mobile_number]}),s.email&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ss,{className:"h-3 w-3"}),s.email]})]})]})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"space-y-1",children:s.business_type_data&&e.jsx(B,{variant:"outline",className:"text-xs bg-blue-900",children:s.business_type_data.name})})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"space-y-2",children:s.lead_status_data&&(s.lead_status_data.name=="Sold"?e.jsx(B,{className:"bg-yellow-600",variant:re(s.lead_status_data.name),children:s.lead_status_data.name}):e.jsx(B,{variant:re(s.lead_status_data.name),children:s.lead_status_data.name}))})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:s.assigned_to_user?e.jsx(B,{className:"bg-blue-500",variant:"secondary",children:s.assigned_to_user.name}):e.jsx("span",{className:"text-muted-foreground",children:"Unassigned"})})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:`text-sm ${s.next_follow_up_date&&new Date(s.next_follow_up_date).getTime()<new Date().setHours(0,0,0,0)?"text-red-500":"text-green-500"}`,children:z(s.next_follow_up_date)})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:z(s.completed_at)})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.assigned_to_user&&e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>Fe(s.assigned_to_user.id),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-800",title:"View user shifts",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>De(s),className:"h-8 w-8 p-0",children:e.jsx(ns,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>Le(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:e.jsx(de,{className:"h-4 w-4"})})]})})]},s.id))})]})})}),o.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",o.from," to ",o.to," of ",o.total," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>t(a-1),disabled:o.current_page===1,children:"Previous"}),Ae().map(s=>e.jsx(f,{variant:s===o.current_page?"default":"outline",size:"sm",onClick:()=>t(s),className:"h-8 w-8 p-0",children:s},s)),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>t(a+1),disabled:o.current_page===o.last_page,children:"Next"})]})]}),e.jsx("div",{className:"flex items-center justify-between border-t pt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Per page:"}),e.jsxs(S,{value:j.toString(),onValueChange:s=>{O(parseInt(s)),t(1)},children:[e.jsx(C,{className:"w-20",children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(h,{value:"5",children:"5"}),e.jsx(h,{value:"10",children:"10"}),e.jsx(h,{value:"25",children:"25"}),e.jsx(h,{value:"50",children:"50"})]})]})]})})]}),!n&&o&&o.data.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"text-muted-foreground",children:"No leads found"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Try adjusting your search or filter criteria"})]})]})]})]}),r&&e.jsx(ds,{isOpen:ue,onClose:ne,onSave:Te,lead:he,formOptions:r}),e.jsx(Ke,{isOpen:xe,onClose:()=>{K(!1),X(null)},userId:pe})]})}export{Fs as default};

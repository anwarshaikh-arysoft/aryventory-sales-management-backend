import{c as k,B as m}from"./app-logo-icon-DEZI2dJj.js";import{r as a,j as e,a as z}from"./app-BP4yl3BC.js";import{D as S,a as y,b as C,c as D,d as F}from"./dialog-CnCDzEzS.js";import{I as w}from"./input-Dq2P0aCI.js";import{B as b}from"./badge-C9qeZdp-.js";import{C as I,c as U}from"./card-Kb3HfW26.js";import{C as $}from"./calendar-BaWBXnz6.js";import{M as H}from"./map-pin-BhbtIOOa.js";import{X as V}from"./app-layout-Cwtnfmx_.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],A=k("Camera",R);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],te=k("ExternalLink",X);function ae({isOpen:x,onClose:E,userId:i}){const[t,M]=a.useState(null),[f,g]=a.useState(!1),[n,L]=a.useState(""),[l,P]=a.useState(""),[c,j]=a.useState(1),[h,u]=a.useState(null),_=async()=>{if(i){g(!0);try{const s=new URLSearchParams({user_id:i.toString(),page:c.toString(),per_page:"10"});n&&s.append("start_date",n),l&&s.append("end_date",l);const r=await z.get(`/api/shift/user-shifts?${s.toString()}`);M(r.data.shifts)}catch(s){console.error("Error fetching user shifts:",s)}g(!1)}};a.useEffect(()=>{x&&i&&_()},[x,i,c,n,l]);const p=s=>s?new Date(s).toLocaleString():"-",d=(s,r=6)=>{if(s==null||s==="")return"N/A";const o=Number(s);return isNaN(o)?"Invalid":o.toFixed(r)},T=(s,r)=>{if(!s||!r)return"-";const o=new Date(s),N=new Date(r).getTime()-o.getTime(),B=Math.floor(N/(1e3*60*60)),q=Math.floor(N%(1e3*60*60)/(1e3*60));return`${B}h ${q}m`},v=s=>{u(s)};return e.jsxs(e.Fragment,{children:[e.jsx(S,{open:x,onOpenChange:E,children:e.jsxs(y,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(C,{children:[e.jsx(D,{children:"User Shift Details"}),e.jsx(F,{children:"View shift timings, locations, and selfies for the selected user"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(w,{type:"date",value:n,onChange:s=>L(s.target.value)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(w,{type:"date",value:l,onChange:s=>P(s.target.value)})]}),e.jsx(m,{onClick:_,children:"Filter"})]}),f&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading shifts..."})}),!f&&t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:t.data.map(s=>e.jsx(I,{children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),new Date(s.shift_date).toLocaleDateString()]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Start:"})," ",p(s.shift_start)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"End:"})," ",p(s.shift_end)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Duration:"})," ",T(s.shift_start,s.shift_end)]}),s.total_break_mins&&e.jsxs("div",{children:[e.jsx("strong",{children:"Break:"})," ",s.total_break_mins," minutes"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"Locations"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.shift_start_latitude&&s.shift_start_longitude&&e.jsxs("div",{children:[e.jsx("strong",{children:"Start:"})," ",d(s.shift_start_latitude),", ",d(s.shift_start_longitude)]}),s.shift_end_latitude&&s.shift_end_longitude&&e.jsxs("div",{children:[e.jsx("strong",{children:"End:"})," ",d(s.shift_end_latitude),", ",d(s.shift_end_longitude)]}),(!s.shift_start_latitude||!s.shift_start_longitude)&&(!s.shift_end_latitude||!s.shift_end_longitude)&&e.jsx("div",{className:"text-muted-foreground",children:"No location data available"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Selfies"]}),e.jsxs("div",{className:"flex gap-2",children:[s.shift_start_selfie_url&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:s.shift_start_selfie_url,alt:"Start selfie",className:"w-16 h-16 object-cover rounded cursor-pointer hover:opacity-80",onClick:()=>v(s.shift_start_selfie_url)}),e.jsx(b,{variant:"outline",className:"text-xs mt-1",children:"Start"})]}),s.shift_end_selfie_url&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:s.shift_end_selfie_url,alt:"End selfie",className:"w-16 h-16 object-cover rounded cursor-pointer hover:opacity-80",onClick:()=>v(s.shift_end_selfie_url)}),e.jsx(b,{variant:"outline",className:"text-xs mt-1",children:"End"})]}),!s.shift_start_selfie_url&&!s.shift_end_selfie_url&&e.jsx("div",{className:"text-muted-foreground text-sm",children:"No selfies available"})]})]})]})})},s.id))}),t.last_page>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>j(c-1),disabled:t.current_page===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-3 text-sm",children:["Page ",t.current_page," of ",t.last_page]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>j(c+1),disabled:t.current_page===t.last_page,children:"Next"})]}),t.data.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No shifts found for the selected criteria"})]})]})]})}),h&&e.jsx(S,{open:!!h,onOpenChange:()=>u(null),children:e.jsxs(y,{className:"max-w-3xl",children:[e.jsxs(C,{children:[e.jsx(D,{children:"Shift Selfie"}),e.jsx(m,{variant:"ghost",size:"sm",className:"absolute right-4 top-4",onClick:()=>u(null),children:e.jsx(V,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:h,alt:"Shift selfie",className:"max-w-full max-h-[70vh] object-contain rounded"})})]})})]})}export{A as C,te as E,ae as U};
